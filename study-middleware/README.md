# 一、mysql

## 1.1 索引	

索引是帮助MySQL高效获取数据的<span style="color:red">排好序</span>的<span style="color:red">数据结构</span>

1. 索引数据结构 

   - 二叉树（如果是有序的会变成链表，不会加快查询）
   - 红黑树（加快一半，比二叉树高度会低一点）
   - Hash表
     - 对索引的key进行一次hash计 算就可以定位出数据存储的位置
     - 很多时候Hash索引要比B+树索引更高效
     - 仅能满足"="，"IN" ，但不支持范围查询
     - hash冲突问题
   - B Tree 
     - 叶节点具有相同的深度，叶节点的指针为空
     - 所有索引元素不重复
     - 节点中的数据索引从左到右递增排列
   - B+Tree (一个节点16KB,bigint=>存1170个索引)
     - 非叶子节点不存储data,只存储索引(冗余)，可以放更多的索引
     - 叶子节点包含所有索引字段
     - 叶子节点用指针连接（双向），提高区间访问的性能
2. 存储文件

   - MyISAM（frm,MYD,MYI）

   - InnoDB（聚集）（frm,ibd）把索引与数据存放在一起

     - 表数据文件本身就是按B + Tree组织的一个索引结构文件

     - 聚集索引-叶节点包含了完整的数据记录

     - 为什么建议InnoDB表必须建主键，并且推荐使用整型的自增主键?

       如果不建主键，mysql会自己去建一个rowid去帮我管理表数据，然后去构建B+Tree

       使用整理的id在构建B+Tree时，在比较大小时，会比uuid快；整理使用的空间也会比uuid更节约。

       自增的原因是方便 区间查询；还有是自增时不会发成分裂，在空间不够时，直接在尾部添加

     - 为什么非主键索引结构叶子节点存储的是主键值? (一致性和节省存储空间)

3. explain 查询执行计划

  4.聚集索引与非聚集索引的区别

- 聚集索引一个表只能有一个，而非聚集索引一个表可以存在多个

- 聚集索引存储记录是物理上连续存在，而非聚集索引是逻辑上的连续，物理存储并不连续

- 聚集索引：物理存储按照索引排序；聚集索引是一种索引组织形式，索引的键值逻辑顺序决定了表数据行的物理存储顺序

- 非聚集索引：物理存储不按照索引排序；非聚集索引则就是普通索引了，仅仅只是对数据列创建相应的索引，不影响整个表的物理存储顺序.

- 索引是通过二叉树的数据结构来描述的，我们可以这么理解聚簇索引：索引的叶节点就是数据节点。而非聚簇索引的叶节点仍然是索引节点，只不过有一个指针指向对应的数据块。

